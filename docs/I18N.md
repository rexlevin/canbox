# Canbox 国际化 (i18n) 文档

## 概述

Canbox 已集成 Vue I18n 实现多语言支持，当前支持简体中文和英文。

## 安装依赖

```bash
npm install vue-i18n@9
```

## 目录结构

```
canbox/
├── locales/
│   ├── zh-CN.json          # 简体中文翻译
│   ├── en-US.json          # 英文翻译
│   └── index.js            # i18n 模块（主进程使用）
├── src/
│   └── i18n.js            # Vue I18n 配置（渲染进程使用）
└── preload.js              # 暴露 i18n API 到渲染进程
```

## 使用方法

### 前端组件中使用

```vue
<template>
  <div>{{ $t('app.title') }}</div>
  <div>{{ $t('devApp.addApp') }}</div>
</template>
```

### 主进程中使用

```javascript
const { translate } = require('./locales');

// 使用默认语言（zh-CN）
const title = translate('app.title');

// 指定语言
const title = translate('app.title', 'en-US');

// 带参数
const msg = translate('common.welcome', 'en-US', { name: 'User' });
```

### IPC API

```javascript
// 获取当前语言
const lang = await window.api.i18n.getLanguage();

// 设置语言
await window.api.i18n.setLanguage('en-US');

// 获取可用语言列表
const languages = await window.api.i18n.getAvailableLanguages();

// 翻译（主进程）
const text = await window.api.i18n.translate('app.title');
```

## 添加新语言

1. 在 `locales/` 目录下创建新的 JSON 文件，如 `ja-JP.json`
2. 参照 `zh-CN.json` 的结构翻译所有键值
3. 在 `src/i18n.js` 中添加新语言的加载器：

```javascript
const messages = {
  'zh-CN': () => import('../locales/zh-CN.json'),
  'en-US': () => import('../locales/en-US.json'),
  'ja-JP': () => import('../locales/ja-JP.json')  // 添加这一行
};
```

## 添加新翻译

1. 在 `locales/zh-CN.json` 中添加新的键值对
2. 在 `locales/en-US.json` 中添加对应的英文翻译
3. 在组件中使用 `$t('key.path')` 引用

### 翻译文件结构

```json
{
  "category": {
    "key": "翻译文本"
  }
}
```

### 命名规范

- 使用小写字母和连字符：`my-setting`
- 使用点号分隔层级：`app.title`
- 使用描述性名称：`save-success` 而不是 `success`

## 语言设置

语言设置保存在 `userData/i18n-config.json`：

```json
{
  "language": "zh-CN"
}
```

## 自动语言检测

应用启动时会：
1. 读取保存的语言设置
2. 如果没有保存的设置，则根据系统语言自动选择：
   - `zh-CN`、`zh-*` → 简体中文
   - 其他语言 → 英文
